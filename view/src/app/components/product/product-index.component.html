<!-- HEADER -->
<app-header></app-header>


<div class="main-wrapper py-4" style="background-color: #f4f6f8; min-height: 100vh;">
  <div class="container">

    <div class="row g-3 mb-4">

      <div class="col-lg-3 d-none d-lg-block">
        <div class="category-box bg-white rounded shadow-sm h-100">
          <h6 class="fw-bold p-3 border-bottom m-0 d-flex align-items-center gap-2">
            <span>üìÇ</span> DANH M·ª§C S·∫¢N PH·∫®M
          </h6>
          <ul class="category-list list-unstyled m-0 p-2">
            <li (click)="filterByCategory(null)" [class.active]="selectedCategory === 0">
              <span>üì±</span> T·∫•t c·∫£ s·∫£n ph·∫©m
              <i class="fas fa-chevron-right float-end opacity-50"></i>
            </li>
            <li *ngFor="let c of categories" (click)="filterByCategory(c.id ?? 0)"
              [class.active]="selectedCategory === c.id">
              <span>üîπ</span> {{ c.name }}
              <i class="fas fa-chevron-right float-end opacity-50"></i>
            </li>
          </ul>
        </div>
      </div>

      <div class="col-lg-6 col-md-12">
        <div id="promoCarousel" class="carousel slide shadow-sm rounded overflow-hidden mb-2" data-bs-ride="carousel"
          data-bs-interval="3000">
          <div class="carousel-indicators">
            <button *ngFor="let img of sliderImages; let i = index" type="button" data-bs-target="#promoCarousel"
              [attr.data-bs-slide-to]="i" [class.active]="i === 0"></button>
          </div>
          <div class="carousel-inner">
            <div *ngFor="let img of sliderImages; let i = index" class="carousel-item" [class.active]="i === 0">
              <img [src]="img" class="d-block w-100 main-slider-img" alt="Slide">
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#promoCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#promoCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>

        <div class="row g-2">
          <div class="col-6" *ngFor="let subImg of subBanners">
            <div class="sub-banner-box rounded shadow-sm overflow-hidden">
              <img [src]="subImg" class="img-fluid w-100 sub-banner-img">
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-3 d-none d-lg-block">
        <div class="promotion-box bg-white rounded shadow-sm h-100 p-3">
          <h6 class="fw-bold mb-3 text-danger text-uppercase border-bottom pb-2">üî• ∆Øu ƒë√£i Hot</h6>
          <ul class="list-unstyled promotion-list">
            <li><span class="badge bg-primary me-2">NEW</span>Thu c≈© l√™n ƒë·ªùi - Tr·ª£ gi√° 1tr</li>
            <li><span class="badge bg-danger me-2">HOT</span>Gi·∫£m 50% g√≥i b·∫£o h√†nh</li>
            <li><span class="badge bg-success me-2">SALE</span>Ph·ª• ki·ªán mua k√®m gi·∫£m 20%</li>
            <li><span class="badge bg-warning text-dark me-2">VIP</span>Tr·∫£ g√≥p 0% l√£i su·∫•t</li>
          </ul>
          <div class="mt-3">
            <img src="../../../assets/favicon_io/favicon-32x32.png" class="img-fluid rounded">
          </div>
        </div>
      </div>

    </div>
    <div class="product-section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="fw-bold text-uppercase m-0" style="color: #444;">
          S·∫£n ph·∫©m n·ªïi b·∫≠t
        </h4>
        <a href="#" class="text-decoration-none text-muted small">Xem t·∫•t c·∫£ ></a>
      </div>

      <div *ngIf="products.length > 0; else loading" class="row g-3">

        <div *ngFor="let product of products" class="col-xl-3 col-lg-4 col-md-6 col-6">
          <div class="product-card card h-100 border-0 shadow-sm">

            <div class="card-img-wrapper" (click)="viewProduct(product.id)">
              <div class="badge-discount">-15%</div>
              <img *ngIf="product.image" [src]="'http://localhost:8000/storage/' + product.image" class="card-img-top"
                alt="{{ product.name }}">
            </div>

            <div class="card-body d-flex flex-column p-3">
              <h6 class="card-title fw-bold" (click)="viewProduct(product.id)" title="{{ product.name }}">
                {{ product.name }}
              </h6>

              <div class="price-box mb-2">
                <span class="current-price">{{ product.price | currency:'VND' }}</span>
                <span class="old-price text-muted text-decoration-line-through small ms-2">
                  {{ (product.price * 1.15) | currency:'VND' }}
                </span>
              </div>

              <div class="stock-status mb-2">
                <span class="badge bg-light text-dark border" *ngIf="(product.quantity ?? 0) > 0">
                  ‚úÖ C√≤n h√†ng
                </span>
                <span class="badge bg-secondary" *ngIf="(product.quantity ?? 0) <= 0">
                  ‚ùå H·∫øt h√†ng
                </span>
              </div>

              <div class="mt-auto action-area">

                <div *ngIf="product.id !== undefined" class="d-flex align-items-center mb-2 gap-2">
                  <small class="text-muted">SL:</small>
                  <input type="number" min="1" class="form-control form-control-sm text-center qty-input"
                    [(ngModel)]="quantities[product.id]" />
                </div>

                <div class="d-grid gap-2">
                  <button class="btn btn-danger btn-sm fw-bold" (click)="addToCart(product.id)">
                    <i class="fas fa-cart-plus"></i> Th√™m v√†o gi·ªè h√†ng
                  </button>
                  <button class="btn btn-outline-dark btn-sm" (click)="viewProduct(product.id)">
                    Xem chi ti·∫øt
                  </button>
                </div>

              </div>

            </div>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>


<ng-template #loading>
  <div class="text-center py-5">
    <div class="spinner-border text-danger" role="status"></div>
    <p class="mt-2 text-muted">ƒêang t·∫£i s·∫£n ph·∫©m...</p>
  </div>
</ng-template>

<!-- TOP BANNER -->
<!-- <div class="top-banner text-center text-white py-1" style="background: #000;">
  <strong>üî• Black Fire-Day 2025 s·∫Øp tr·ªü l·∫°i - ƒêƒÉng k√Ω ngay! üî•</strong>
</div> -->

<!-- NAVIGATION D∆Ø·ªöI HEADER -->
<!-- <div class="nav-categories shadow-sm py-2" style="background: #fff;">
  <div class="container d-flex justify-content-center gap-4 fw-bold">
    <a class="text-danger" href="#">M·ª™NG KHAI TR∆Ø∆†NG</a>
    <a href="#">IPHONE 17 SERIES</a>
    <a href="#">GALAXY S25 FE</a>
    <a href="#">IPAD PRO</a>
    <a href="#">AIRPODS</a>
    <a href="#">Mua s·∫Øm online</a>
  </div>
</div> -->