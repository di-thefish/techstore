<!-- HEADER -->
<div class="header-main py-3" style="background-color: #d70018;">
  <div class="container d-flex justify-content-between align-items-center">

    <a (click)="goHome()"
       class="text-white text-decoration-none fw-bold fs-4 me-4"
       style="cursor: pointer;">
      STORE
    </a>

    <div class="d-flex align-items-center gap-3 text-white">

      <span *ngIf="isLoggedIn && user" class="fw-bold d-none d-md-block">
        Xin chÃ o, {{ user.name }}
      </span>

      <ng-container *ngIf="isLoggedIn">

<!-- USER: ÄÆ¡n hÃ ng cÃ¡ nhÃ¢n -->
<button *ngIf="!isAdmin"
        (click)="goOrders()"
        class="btn btn-light fw-bold">
  ğŸ“¦ ÄÆ¡n hÃ ng cá»§a tÃ´i
</button>

<!-- ADMIN: Quáº£n lÃ½ Ä‘Æ¡n hÃ ng -->
<button *ngIf="isAdmin"
        (click)="goOrders()"
        class="btn btn-danger fw-bold">
  ğŸ“¦ Quáº£n lÃ½ Ä‘Æ¡n hÃ ng
</button>


        <!-- ğŸ›’ GIá» HÃ€NG -->
        <button *ngIf="!isAdmin"
                (click)="goCart()"
                class="btn btn-cart-custom position-relative fw-bold">
          ğŸ›’ Giá» hÃ ng
          <span *ngIf="cartItemCount > 0"
                class="position-absolute top-0 start-100 translate-middle
                       badge rounded-pill bg-warning text-dark border border-light">
            {{ cartItemCount }}
          </span>
        </button>

        <!-- ADMIN -->
        <button *ngIf="isAdmin"
                (click)="addProductModal()"
                class="btn btn-warning fw-bold text-dark">
          â• ThÃªm sáº£n pháº©m
        </button>

      </ng-container>

      <!-- AUTH -->
      <button *ngIf="!isLoggedIn"
              (click)="goLogin()"
              class="btn btn-light text-danger fw-bold">
        ÄÄƒng nháº­p
      </button>

      <button *ngIf="isLoggedIn"
              (click)="logout()"
              class="btn btn-light border-light">
        ÄÄƒng xuáº¥t
      </button>

    </div>
  </div>
</div>


<!-- TOP BANNER -->
<div class="top-banner text-center text-white py-1" style="background: #000;">
  <strong>ğŸ”¥ Black Fire-Day 2025 sáº¯p trá»Ÿ láº¡i - ÄÄƒng kÃ½ ngay! ğŸ”¥</strong>
</div>

<!-- NAVIGATION DÆ¯á»šI HEADER -->
<div class="nav-categories shadow-sm py-2" style="background: #fff;">
  <div class="container d-flex justify-content-center gap-4 fw-bold">
    <a class="text-danger" href="#">Má»ªNG KHAI TRÆ¯Æ NG</a>
    <a href="#">IPHONE 17 SERIES</a>
    <a href="#">GALAXY S25 FE</a>
    <a href="#">IPAD PRO</a>
    <a href="#">AIRPODS</a>
    <a href="#">Mua sáº¯m online</a>
  </div>
</div>

<!-- MAIN LAYOUT -->
<div class="container mt-3">
  <div class="row">

    <!-- SIDEBAR DANH Má»¤C -->
    <div class="col-md-3">
      <div class="category-menu p-3 shadow-sm rounded" style="background: #fff;">
        <h5 class="fw-bold mb-3">Danh má»¥c</h5>

        <ul class="list-unstyled">
          <li class="py-2 border-bottom" style="cursor: pointer;" (click)="filterByCategory(null)">
              Táº¥t cáº£ sáº£n pháº©m
          </li>

          <li *ngFor="let c of categories"
              class="py-2 border-bottom"
              style="cursor: pointer;"
              (click)="filterByCategory(c.id ?? 0)">
              {{ c.name }}
          </li>
        </ul>
      </div>
    </div>

    <!-- SLIDER CHÃNH -->
    <div class="col-md-6">
      <div class="main-banner mb-3">
        <img
          src="https://cdn2.cellphones.com.vn/insecure/rs:fill:0:358/q:90/plain/https://cellphones.com.vn/media/catalog/product/i/p/iphone-17-pro-cam_4.jpg"
          class="img-fluid rounded shadow-sm" alt="slider">
      </div>

      <div class="row g-2">
        <div class="col-6">
          <img
            src="https://cdn2.cellphones.com.vn/insecure/rs:fill:0:358/q:90/plain/https://cellphones.com.vn/media/catalog/product/s/a/samsung-galaxy-s25-fe-3.jpg"
            class="img-fluid rounded shadow-sm">
        </div>
        <div class="col-6">
          <img
            src="https://cdn2.cellphones.com.vn/insecure/rs:fill:0:358/q:90/plain/https://cellphones.com.vn/media/catalog/product/i/p/ipad-pro-m5.jpg"
            class="img-fluid rounded shadow-sm">
        </div>
      </div>
    </div>

    <!-- Æ¯U ÄÃƒI BÃŠN PHáº¢I -->
    <div class="col-md-3">
      <div class="side-banner p-3 rounded shadow-sm" style="background: #fff;">
        <ul class="list-unstyled">
          <li class="py-2 border-bottom">ğŸ“ Æ¯u Ä‘Ã£i giÃ¡o dá»¥c</li>
          <li class="py-2 border-bottom">ğŸ ÄÄƒng kÃ½ nháº­n Æ°u Ä‘Ã£i</li>
          <li class="py-2 border-bottom">ğŸ” Thu cÅ© lÃªn Ä‘á»i</li>
          <li class="py-2 border-bottom">ğŸ’» Laptop giáº£m Ä‘áº¿n 500K</li>
          <li class="py-2">ğŸ“± iPhone trá»£ giÃ¡ 5 triá»‡u</li>
        </ul>
      </div>
    </div>

  </div>
</div>

<!-- DANH SÃCH Sáº¢N PHáº¨M -->
<div *ngIf="products.length > 0; else loading" class="container mt-4">
  <h3 class="fw-bold mb-3">ğŸ”¥ Sáº£n pháº©m ná»•i báº­t</h3>

  <div class="row g-3">
    <div *ngFor="let product of products" class="col-md-4 col-sm-6">
      <div class="card h-100 shadow-sm">

        <img *ngIf="product.image"
          [src]="'http://localhost:8000/storage/' + product.image"
          class="img-fluid rounded shadow-sm"
          style="height: 200px; object-fit: cover;">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ product.name }}</h5>
          <p class="card-text text-danger fw-bold">GiÃ¡: {{ product.price | currency:'VND' }}</p>
          <p><strong>Danh má»¥c:</strong> {{ product.category?.name || 'KhÃ´ng cÃ³' }}</p>

          <p>
            <strong>Tráº¡ng thÃ¡i:</strong>
            <span [class.text-success]="(product.quantity ?? 0) > 0"
                  [class.text-danger]="(product.quantity ?? 0) <= 0">
              {{ (product.quantity ?? 0) > 0 ? 'CÃ²n hÃ ng' : 'Háº¿t hÃ ng' }}
            </span>
          </p>

          <!-- INPUT Sá» LÆ¯á»¢NG -->
          <div *ngIf="product.id !== undefined" class="mb-2">
            <label class="form-label">Sá»‘ lÆ°á»£ng</label>
            <input type="number" min="1" class="form-control w-50" [(ngModel)]="quantities[product.id]" />
          </div>

          <!-- BUTTONS -->
          <div class="mt-auto">
            <button class="btn btn-primary w-100 mb-2" (click)="addToCart(product.id)">
              ğŸ›’ ThÃªm vÃ o giá» hÃ ng
            </button>
            <button class="btn btn-outline-secondary w-100" (click)="viewProduct(product.id)">
              ğŸ‘ Xem chi tiáº¿t
            </button>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
  <p class="text-center mt-3">Äang táº£i sáº£n pháº©m...</p>
</ng-template>
